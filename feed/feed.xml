<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
	<title>Jonathan Schrack</title>
	<subtitle></subtitle>
	
	<link href="https://jmschrack.dev/feed/feed.xml" rel="self"/>
	<link href="https://jmschrack.dev/"/>
	<updated>2020-07-20T00:00:00-00:00</updated>
	<id></id>
	<author>
		<name>Jonathan Schrack</name>
		<email>jonathan.schrack@digitalprecept.com</email>
	</author>
	
	<entry>
		<title>Sanity Razor</title>
		<link href="https://jmschrack.dev/posts/SanityRazor/"/>
		<updated>2016-02-24T00:00:00-00:00</updated>
		<id>https://jmschrack.dev/posts/SanityRazor/</id>
		<content type="html">&lt;p&gt;This was the first project I worked on at Digital Precept. Development was on a Oculus DK2 and Unity5. The game is best described as &amp;quot;Steel Batallion vs Call of Cthulhu.&amp;quot;&lt;br&gt;
It was first demoed at PAX:South 2016 with great praise from the players who tried it.&lt;br&gt;
However, this was still the halcyon days of VR development and our basic training demo was pushing the system to its limits to hit 90FPS, and so the studio made the decision to stop working on it for now.&lt;/p&gt;
&lt;p&gt;The project is not considered cancelled as the studio would like to revisit the idea in the future; the project&#39;s status is &amp;quot;on ice.&amp;quot;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&amp;quot;That is not dead which can eternal lie. And with strange aeons even death may die.&amp;quot; - &lt;em&gt;Call of Cthulhu&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;the-greenlight-trailer&quot;&gt;The Greenlight Trailer &lt;a class=&quot;direct-link&quot; href=&quot;#the-greenlight-trailer&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/UsRlwK7xg_s&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;
&lt;h1 id=&quot;novel-features&quot;&gt;Novel features &lt;a class=&quot;direct-link&quot; href=&quot;#novel-features&quot;&gt;#&lt;/a&gt;&lt;/h1&gt;
&lt;p&gt;&lt;em&gt;At time of writing, it&#39;s 2020. Many of these features are trivial or easy now that the XR industry has had 4 years to mature.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;We had a monoscopic HUD that only rendered on your left eye. This allowed use to render targeting pips for ease of aiming and enemy awareness.&lt;br&gt;
Dual camera setups in Unity3D were prohibitively expensive, and we didn&#39;t want to deal with &amp;quot;impossible geometry&amp;quot; by rendering the HUD as floating 3D elements.&lt;/p&gt;
&lt;p&gt;The simple solution:  render it like a real world HUD. The Entirety of the HUD is rendered roughly 1.5 inches to the left of the camera&#39;s center point. Or roughly 1 inch in front of your (virtual) eyeball.&lt;br&gt;
The SinglePass Stereo translation math would naturally occlude this from the right eye.&lt;br&gt;
Furthermore, there is only one world space canvas with all elements including the cockpit displays attached to it. This keeps all the UI drawcalls to a single batch.&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>Unity3D AMF-Importer</title>
		<link href="https://jmschrack.dev/posts/UnityAMFImporter/"/>
		<updated>2019-02-04T00:00:00-00:00</updated>
		<id>https://jmschrack.dev/posts/UnityAMFImporter/</id>
		<content type="html">&lt;p&gt;&lt;img src=&quot;https://jmschrack.dev/img/AMFImporter.png&quot; alt=&quot;alt text&quot; title=&quot;Adjutant to Unity&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;the-impetus&quot;&gt;The impetus &lt;a class=&quot;direct-link&quot; href=&quot;#the-impetus&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;I wanted to test the efficiency of rendering a FPS multiplayer map on some low end hardware. So I started to make a map when I realized, why waste time on a theoretical map, when I could use an existing map from an FPS? Then I recalled that I used to play a lot of Halo:CE in college.  Not &amp;quot;Combat Evolved&amp;quot; but &amp;quot;&lt;em&gt;Custom Edition&lt;/em&gt;&amp;quot;.&lt;/p&gt;
&lt;p&gt;Custom Edition had tools that allowed the community to create custom levels, maps, guns, etc. But I didn&#39;t want to use someone else&#39; map; I wanted to use one of the official maps as a benchmark for my performance test. So I did some research and came across a fan made tool called &amp;quot;Adjutant&amp;quot; that lets you extract geometry and textures from the Halo map files. Even better it supported Halo 3 assets! So I open up &amp;quot;Isolation&amp;quot; multiplayer map from Halo 3. Extract the textures as PNGs and extract the model as... AMF?&lt;/p&gt;
&lt;h2 id=&quot;down-the-rabbit-hole...&quot;&gt;Down the rabbit hole... &lt;a class=&quot;direct-link&quot; href=&quot;#down-the-rabbit-hole...&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;So the Adjutant mod team had created their own model file format to extract as.  They then provided an import script plugin for 3DS...2005.  I don&#39;t own 3DS Max, much less the older precursor. So I started investigating if anyone had made a Blender plugin that could import AMF.  No one had. Most of the documentation and mod posts I was finding for Halo:CE were circa 2003 at best. However, by chance I ran across a forum post dated late 2018 of someone talking about making a Blender plugin.&lt;/p&gt;
&lt;p&gt;Huge shoutout to Shelley and the rest of the folks over on the Reclaimers discord. Shelley had a decompiled version of the 3DS importer plugin. With this, I was able to write my own C# importer to allow Unity to import AMF files natively as if they were 3D models! ...almost.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://jmschrack.dev/img/IsolationFubar.png&quot; alt=&quot;alt text&quot; title=&quot;Isolation messed up&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;geometry&quot;&gt;Geometry &lt;a class=&quot;direct-link&quot; href=&quot;#geometry&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Huge thanks to &lt;a href=&quot;https://www.linkedin.com/in/kimberly-duran-80b16b149/&quot;&gt;Kim Duran&lt;/a&gt; &amp;amp; &lt;a href=&quot;https://www.linkedin.com/in/hunter-gore-9960b0148&quot;&gt;Hunter Gore&lt;/a&gt; for helping me with matrix transform math!&lt;/p&gt;
&lt;p&gt;Halo/3DS uses a right handed, z-up coordinate system, while Unity uses a left-handed Y-up system.  Converting between the two ended up being slightly trickier than it should have been. As the coordinates would be extracted from the raw AMF file, but then certain modifiers and transforms would be applied based on the geometry name.&lt;br&gt;
&lt;img src=&quot;https://jmschrack.dev/img/IsolationFubar2.png&quot; alt=&quot;alt text&quot; title=&quot;Isolation partially correct&quot;&gt;&lt;/p&gt;
&lt;p&gt;Thankfully, geometry falls into two catergories of terrain or instances.&lt;br&gt;
&lt;img src=&quot;https://jmschrack.dev/img/IsolationFixedGeo.png&quot; alt=&quot;alt text&quot; title=&quot;Isolation slightly less messed up&quot;&gt;&lt;br&gt;
...But what&#39;s up with the crushed blacks?&lt;/p&gt;
&lt;h2 id=&quot;materials&quot;&gt;Materials &lt;a class=&quot;direct-link&quot; href=&quot;#materials&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The AMF file format has data in it for setting up textures and materials into the shaders. Every material has an array of textures, colors, and normal maps. Unfortunately the 3DS importer script does not support anything other than a basic diffuse set up. However, looking at the textures referenced, the AMF file would preserve indexes and leave in null fields. So a pattern can be observed with what texture indexes are albedo, normals, color change, and lighting.&lt;br&gt;
That get&#39;s us about 75% of the way there, but we still have these weird, crushed black looking materials.&lt;br&gt;
&lt;img src=&quot;https://jmschrack.dev/img/crushedBlackRock.png&quot; alt=&quot;alt text&quot; title=&quot;Rocks with Crushed Black&quot;&gt;&lt;br&gt;
That ends up being an easy fix.  The textures have been pre-converted to linear colorspace, but by default Unity (and everything else) imports the texture as Gamma and then converts to linear. So changing the texture&#39;s sRGB setting to false fixed the colors and gets shadows to play nice as well!&lt;br&gt;
&lt;img src=&quot;https://jmschrack.dev/img/RocksInShade.png&quot; alt=&quot;alt text&quot; title=&quot;Fixed rocks&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;rigged-importing&quot;&gt;Rigged Importing &lt;a class=&quot;direct-link&quot; href=&quot;#rigged-importing&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;It even works with rigged meshes, but that was whole other process of figuring out the right transforms to apply at certain steps. I saved a few screenshots of the more interesting steps in the process.&lt;/p&gt;
&lt;p&gt;The correct skeleton is on the left. That wadded up ball of lines? That&#39;s the imported skeleton.&lt;br&gt;
&lt;img src=&quot;https://jmschrack.dev/img/MCRig1.png&quot; alt=&quot;alt text&quot; title=&quot;Wadded up ball of skeleton&quot;&gt;&lt;/p&gt;
&lt;p&gt;Skeleton is looking right, except it took a long walk off a short cliff.&lt;br&gt;
&lt;img src=&quot;https://jmschrack.dev/img/MCRig2.png&quot; alt=&quot;alt text&quot; title=&quot;Skeleton sleeping on the job&quot;&gt;&lt;/p&gt;
&lt;p&gt;Skeleton is right, but the 3D mesh is not?&lt;br&gt;
&lt;img src=&quot;https://jmschrack.dev/img/MCRig3.png&quot; alt=&quot;alt text&quot; title=&quot;Almost there&quot;&gt;&lt;/p&gt;
&lt;p&gt;Skeleton and mesh imports properly, except a basic idle animation results in MasterChief about to drop the hottest rap album of 2020.&lt;br&gt;
&lt;img src=&quot;https://jmschrack.dev/img/MCRigAnim1.gif&quot; alt=&quot;alt text&quot; title=&quot;MC is bit too gangsta&quot;&gt;&lt;/p&gt;
&lt;p&gt;Easy enough, adjusting MC to be in a T-Pose corrects the avatar&#39;s limb rotations.&lt;br&gt;
&lt;img src=&quot;https://jmschrack.dev/img/MCRigAnimFinal.gif&quot; alt=&quot;alt text&quot; title=&quot;perfect&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;the-end-result&quot;&gt;The End Result &lt;a class=&quot;direct-link&quot; href=&quot;#the-end-result&quot;&gt;#&lt;/a&gt;&lt;/h1&gt;
&lt;p&gt;Is a pretty servicable importer for AMF files into Unity! It&#39;s not perfect, but neither is AMF.&lt;/p&gt;
&lt;p&gt;The full source code is on GitHub:&lt;/p&gt;
&lt;div class=&quot;github-card&quot; data-github=&quot;jmschrack/Unity3D-AMFImporter&quot; data-width=&quot;400&quot; data-height=&quot;153&quot; data-theme=&quot;default&quot;&gt;&lt;/div&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/github-cards/latest/widget.js&quot;&gt;&lt;/script&gt;
&lt;h1 id=&quot;wait-what-about-that-render-test%3F&quot;&gt;Wait what about that Render test? &lt;a class=&quot;direct-link&quot; href=&quot;#wait-what-about-that-render-test%3F&quot;&gt;#&lt;/a&gt;&lt;/h1&gt;
&lt;p&gt;4 player splitscreen hit max frame rate 30FPS on an android tablet. (Screen is locked at VSync. Judging by the CPU stats, it could feasible hit 50+FPS without VSync)&lt;/p&gt;
&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/7W2QDMUuvdY&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;
</content>
	</entry>
	
	<entry>
		<title>BTLE 4 Unity</title>
		<link href="https://jmschrack.dev/posts/BLE4Unity/"/>
		<updated>2019-02-28T00:00:00-00:00</updated>
		<id>https://jmschrack.dev/posts/BLE4Unity/</id>
		<content type="html">&lt;p&gt;&lt;img src=&quot;https://jmschrack.dev/img/BTLE4Unity.jpg&quot; alt=&quot;alt text&quot; title=&quot;BTLE4Unity Title Card&quot;&gt;&lt;/p&gt;
&lt;p&gt;I designed and developed a Bluetooth Low Energy integration for Unity!&lt;br&gt;
Nicknamed BTLE4Unity aka &amp;quot;Beetle&amp;quot;&lt;/p&gt;
&lt;p&gt;The asset is broken into multiple parts for cross platform utilization.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Core API: this is the high level interface that all platforms must implement&lt;/li&gt;
&lt;li&gt;Win API: this wraps the low level Windows SDK Bluetooth calls with C# headers and utilities.&lt;/li&gt;
&lt;li&gt;WebGL API: this wraps the &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/Web_Bluetooth_API&quot;&gt;Javascript Bluetooth implementation&lt;/a&gt; spec via JSLIB bindings.&lt;/li&gt;
&lt;/ul&gt;
</content>
	</entry>
	
	<entry>
		<title>Framed</title>
		<link href="https://jmschrack.dev/posts/Framed/"/>
		<updated>2020-02-10T00:00:00-00:00</updated>
		<id>https://jmschrack.dev/posts/Framed/</id>
		<content type="html">&lt;p&gt;&lt;img src=&quot;https://jmschrack.dev/img/FramedBoseAR.png&quot; alt=&quot;alt text&quot; title=&quot;Framed Title Card&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Created by Craig Herndon, Jonathan Schrack, Michael Gilday, Scott Niejadlik&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Framed combines the Bose AR ecosystem with the spy genre to inspire action and enrich the real world with an engaging narrative. Players put on what appears to be a regular Bose device, only to discover they are now caught up in a thick plot between competing spy agencies. Player choices and reactions can change the outcome of the many encounters they will face.&lt;/p&gt;
&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/hheEyIiuwrM&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;
&lt;p&gt;Find out more at the &lt;a href=&quot;https://playcrafting.com/bose-alliance/&quot;&gt;Playcrafting Website&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;tech-dive&quot;&gt;Tech Dive &lt;a class=&quot;direct-link&quot; href=&quot;#tech-dive&quot;&gt;#&lt;/a&gt;&lt;/h1&gt;
</content>
	</entry>
	
	<entry>
		<title>Mend</title>
		<link href="https://jmschrack.dev/posts/Mend/"/>
		<updated>2020-02-10T00:00:00-00:00</updated>
		<id>https://jmschrack.dev/posts/Mend/</id>
		<content type="html">&lt;p&gt;&lt;img src=&quot;https://jmschrack.dev/img/Mend_400x400.jpg&quot; alt=&quot;alt text&quot; title=&quot;Mend Title Card&quot;&gt;&lt;/p&gt;
&lt;p&gt;I am the main XR and Software Developer for Mend!&lt;br&gt;
Mend is a 2 player, asymetrical co-op game for VR.  It is designed by &lt;a href=&quot;http://jeplmr.com/&quot;&gt;Justin Palmer&lt;/a&gt; and was originally an Oculus LaunchPad title.&lt;br&gt;
I developed the core game systems built to Justin&#39;s specifications, including:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;an XR Interaction Rig we use that abstracts object usage logic away from the core VR camera rig.
&lt;ul&gt;
&lt;li&gt;&amp;quot;Grab &amp;amp; Pull&amp;quot; locomotion keyed to the hand controller update sequence for as smooth as possible movement&lt;/li&gt;
&lt;li&gt;Physics based object manipulation. (aka you can pick up things)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Extensive modifications to FMOD to allow dual speaker outputs so the VR player has their own localized audio that is distinct from the pancake player&lt;/li&gt;
&lt;li&gt;An input remapper built on top of Oculus&#39; OVRInput system to allow easy control customization&lt;/li&gt;
&lt;li&gt;Spatial dependent collision platforms!&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Check out the first gameplay trailer here!&lt;/p&gt;
&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/CKeRf5Wvzjg&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;
&lt;h1 id=&quot;feature-highlight%3A-spatial-dependent-collision&quot;&gt;Feature Highlight: Spatial Dependent Collision &lt;a class=&quot;direct-link&quot; href=&quot;#feature-highlight%3A-spatial-dependent-collision&quot;&gt;#&lt;/a&gt;&lt;/h1&gt;
&lt;p&gt;I&#39;m really proud of this, and I want to explain more in depth.&lt;br&gt;
&lt;em&gt;&lt;strong&gt;Dictionary of Terms&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;VR Player&lt;/strong&gt; : the person wearing the VR headset. This is the &amp;quot;Owl sister&amp;quot; seen in screenshots and gameplay.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Flat Player&lt;/strong&gt; : the person using a controller and computer monitor and &lt;em&gt;no&lt;/em&gt; VR headset. This is the &amp;quot;Fox sister&amp;quot; seen in screenshots and gameplayer.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;inspiration&quot;&gt;Inspiration &lt;a class=&quot;direct-link&quot; href=&quot;#inspiration&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Having invisible platforms is not a novel idea in video games. The logical progression is a tool or item that reveals the platforms.&lt;br&gt;
For an example from Super Mario Odyssey:&lt;br&gt;
&lt;img src=&quot;https://jmschrack.dev/img/smg_invisplat.gif&quot; alt=&quot;alt text&quot; title=&quot;SMG Invis Platform example&quot;&gt;&lt;/p&gt;
&lt;p&gt;The obvious use case for a 2 player game, is that Player1 controls the tool to reveal the platforms that Player2 has to use. However, it didn&#39;t mesh at first with our use case.&lt;/p&gt;
&lt;h2 id=&quot;the-twist&quot;&gt;The Twist &lt;a class=&quot;direct-link&quot; href=&quot;#the-twist&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;I really wish we could make the collisions operate the same way as the visuals. - &lt;em&gt;Justin Palmer&lt;/em&gt;, &lt;em&gt;Mend&#39;s Game Designer&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;The core aspect that Justin wanted to have is that the players &lt;strong&gt;need&lt;/strong&gt; each other, and cannot complete the level without each other.&lt;br&gt;
We already accomplished this with platforms as The VR player is the only player that can move the platforms for the non-VR player to use.&lt;br&gt;
However, once the VR Player revealed the invisible platforms to the Flat Player, the Flat Player could just remember where to run and jump, removing agency from the VR Player as they just had nothing else to do.&lt;/p&gt;
&lt;p&gt;We already had a method of partially rendering platforms that were in range. I then took it one step further, and devised a method of controlling collisions for partials views as well. The Flat Player (and any other physics objects we want!) will now fall through any invisible sections in the geometry.&lt;/p&gt;
&lt;h1 id=&quot;the-result&quot;&gt;The result &lt;a class=&quot;direct-link&quot; href=&quot;#the-result&quot;&gt;#&lt;/a&gt;&lt;/h1&gt;
&lt;p&gt;(animated gif showing partial collision dynamically with a bunch of boxes)&lt;/p&gt;
&lt;p&gt;Now the game really requires team work to complete!&lt;br&gt;
(animated gif showing Owl and Fox working in tandem to platform)&lt;/p&gt;
&lt;h1 id=&quot;more-about-mend&quot;&gt;More about Mend &lt;a class=&quot;direct-link&quot; href=&quot;#more-about-mend&quot;&gt;#&lt;/a&gt;&lt;/h1&gt;
&lt;p&gt;&lt;a class=&quot;twitter-timeline&quot; href=&quot;https://twitter.com/MendTheGame?ref_src=twsrc%5Etfw&quot;&gt;Tweets by MendTheGame&lt;/a&gt; &lt;script async=&quot;&quot; src=&quot;https://platform.twitter.com/widgets.js&quot; charset=&quot;utf-8&quot;&gt;&lt;/script&gt;&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>An Idiot&#39;s Guide to running Eleventy on GitHub Pages.</title>
		<link href="https://jmschrack.dev/posts/SetupGuide/"/>
		<updated>2020-03-05T00:00:00-00:00</updated>
		<id>https://jmschrack.dev/posts/SetupGuide/</id>
		<content type="html">&lt;p&gt;When it comes to text tutorials, I prefer them overly verbose. So I&#39;m documenting my process of getting the Eleventy base blog for the next wandering programmer that might come by.&lt;br&gt;
I&#39;ve used Continuous Integation before, but never TravisCI. I&#39;ve used git and GitHub before, but never GitHub pages. And of course, I&#39;ve never used eleventy before now.&lt;br&gt;
The whole point of SSG is to enable you to just focus on the content of your website, and not the infrastructure. However, if you haven&#39;t used all of these components, guess what you&#39;re wasting time trying to figure out?&lt;br&gt;
So an &amp;quot;Idiot&#39;s Guide&amp;quot; is to enable anyone (not necessarily developers!) to do the bare minimum infrastructure set up in order to focus on the content.&lt;br&gt;
The only assumption is that you know commit&amp;amp;push to a git repo.&lt;/p&gt;
&lt;h2 id=&quot;what-is-this%3F&quot;&gt;What is this? &lt;a class=&quot;direct-link&quot; href=&quot;#what-is-this%3F&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Eleventy is a &amp;quot;Static Site Generator&amp;quot; that lets you type up pages in simple markdown, and then it generates all the html and CSS required.&lt;br&gt;
GitHub Pages will host static HTML websites based on a git repo.&lt;br&gt;
TravisCI will auto pull your latest code, build it, and deploy for you.&lt;br&gt;
All 3 of these together make for a straight forward website pipeline.&lt;/p&gt;
&lt;h2 id=&quot;get-node.js-(optional)&quot;&gt;Get Node.js (Optional) &lt;a class=&quot;direct-link&quot; href=&quot;#get-node.js-(optional)&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Eleventy uses JavaScript and runs on Node.js.  TravisCI will handle all of this for us, and so you don&#39;t have to install node.js yourself.&lt;br&gt;
However, it&#39;s a good idea to do this so you can rapidly test changes on your local computer before pushing them live.&lt;/p&gt;
&lt;p&gt;You can download an installer for Node.js from &lt;a href=&quot;https://nodejs.org/en/download/&quot;&gt;https://nodejs.org/en/download/&lt;/a&gt;. Let it do its thing.&lt;/p&gt;
&lt;h2 id=&quot;get-eleventy&quot;&gt;Get Eleventy &lt;a class=&quot;direct-link&quot; href=&quot;#get-eleventy&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;(From &lt;a href=&quot;https://www.11ty.dev/&quot;&gt;https://www.11ty.dev/&lt;/a&gt; )&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Open up Windows Powershell (or command prompt).&lt;/li&gt;
&lt;li&gt;run &amp;quot;npm install -g @11ty/eleventy&amp;quot;  (without quotes)&lt;/li&gt;
&lt;li&gt;Go to &lt;a href=&quot;https://github.com/11ty/eleventy-base-blog&quot;&gt;https://github.com/11ty/eleventy-base-blog&lt;/a&gt; and choose &amp;quot;Use This Template&amp;quot; button. Name your repo whatever you want, or leave the default name.&lt;/li&gt;
&lt;li&gt;On your freshly created/cloned GitHub repository, create a new branch called &amp;quot;dev&amp;quot; (Or whatever you want, all your work will be done here.)  If you want to set this up for a specific repo instead of your &amp;quot;User page&amp;quot;, call the branch &amp;quot;gh-pages&amp;quot;, and skip to step 6.&lt;/li&gt;
&lt;li&gt;On your github repo&#39;s settings, change the default branch to &amp;quot;dev&amp;quot; and rename your repo to &lt;em&gt;username&lt;/em&gt;.github.io&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;set-up-travisci-to-publish-your-github-repo&quot;&gt;Set up TravisCI to publish your GitHub repo &lt;a class=&quot;direct-link&quot; href=&quot;#set-up-travisci-to-publish-your-github-repo&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;ol start=&quot;6&quot;&gt;
&lt;li&gt;Go to &lt;a href=&quot;https://travis-ci.org/getting_started&quot;&gt;https://travis-ci.org/getting_started&lt;/a&gt; , sign in with github. If you&#39;re feeling lazy, just activate Travis for all repositories.&lt;/li&gt;
&lt;li&gt;On GitHub, go to your profile Settings&amp;gt;Developer Settings&amp;gt;Personal Access Tokens, and create a new personal access token for TravisCI with the &amp;quot;Repo&amp;quot; permissions. &lt;strong&gt;Copy the key!&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Go to TravisCI and navigate to your repository, and go to the settings for it. Create a new EnvironmentVariable called &amp;quot;GITHUB_TOKEN&amp;quot;, paste the Access Token you copied in here and click &amp;quot;Add&amp;quot;&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;publish-your-page-for-the-first-time&quot;&gt;Publish your page for the first time &lt;a class=&quot;direct-link&quot; href=&quot;#publish-your-page-for-the-first-time&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;ol start=&quot;9&quot;&gt;
&lt;li&gt;If you are not using the User page (i.e. you skipped step 5 above), just change the &amp;quot;pathprefix&amp;quot; in .travis.yml to point to your repo&#39;s name. Otherwise, edit your .travis.yml and change it to the following.:&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;language: node_js
node_js:
  - 8
before_script:
  - npm install @11ty/eleventy -g
script: eleventy --pathprefix=&amp;quot;/&amp;quot;
deploy:
  local-dir: _site
  provider: pages
  skip-cleanup: true
  github-token: $GITHUB_TOKEN  # Set in travis-ci.org dashboard, marked secure
  keep-history: true
  target_branch: master
  on:
    branch: dev
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This tells TravisCI to pull from the dev branch, and deploy to the master branch.&lt;br&gt;
10. Commit and push your changes now. Go back to TravisCI and watch your build begin.&lt;br&gt;
11. Once Travis finishes, go to your &lt;a href=&quot;http://github.com/&quot;&gt;GitHub.com&lt;/a&gt; repo&#39;s settings, scroll down to find the &amp;quot;GitHub Pages&amp;quot; section. If everything worked, you&#39;ll be given a link that points to &lt;em&gt;username&lt;/em&gt;.github.io !&lt;/p&gt;
&lt;p&gt;The first time, I got an &amp;quot;Unknown Tag&amp;quot; error. I don&#39;t know what caused it, but doing a second build on Jenkins fixed it.&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>Unleash the power of WebGL and Unity</title>
		<link href="https://jmschrack.dev/posts/UnityWebGL/"/>
		<updated>2020-07-20T00:00:00-00:00</updated>
		<id>https://jmschrack.dev/posts/UnityWebGL/</id>
		<content type="html">&lt;p&gt;If you&#39;ve ever used Javascript, you know how much it loves callbacks. Unfortunately at the time of writing, there isn&#39;t any good documentation on how to work with javascript callbacks inside of Unity&#39;s WebGL builds with C#.&lt;/p&gt;
&lt;p&gt;Note: Web browsers only run Javascript or WebASM.  However, in Unity we code in C# which then gets compiled and converted to WebASM, and in order to avoid confusion, I&#39;ll often refer to things as C# instead of WebASM.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;If you&#39;re coming from Unity and C# with little Javascript experience, you might have heard callbacks referred to as &amp;quot;delegates&amp;quot; or &amp;quot;Actions.&amp;quot;  Still not ringing a bell?  If you&#39;ve used a UI button in Unity, the &amp;quot;OnClick&amp;quot; field is a callback!&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&quot;how-to-use-c%23-callbacks-from-javascript&quot;&gt;How to use C# Callbacks from Javascript &lt;a class=&quot;direct-link&quot; href=&quot;#how-to-use-c%23-callbacks-from-javascript&quot;&gt;#&lt;/a&gt;&lt;/h1&gt;
&lt;h2 id=&quot;on-the-c%23-side&quot;&gt;On the C# side &lt;a class=&quot;direct-link&quot; href=&quot;#on-the-c%23-side&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;This is pretty straight forward for C# as the runtime will automatically marshal data for us.  &amp;quot;Marshalling&amp;quot; is the term for converting the data to another format and is necessary as we pass data from C# (technically WebASM) to Javascript and back.  Effectively, these two languages are isolated from each other in memory, but Interops allows these two transfer data and execution to and from each other.&lt;/p&gt;
&lt;p&gt;Let&#39;s look at a C# sample:&lt;br&gt;
(JSAPI.cs)&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;using System;
using System.Runtime.InteropServices;
using AOT;
public class JSAPI{
    
    [DllImport(&amp;quot;__Internal&amp;quot;)]
    private static extern void JSExample(Action callback);

    [MonoPInvokeCallback(typeof(Action))]
    public static void DefaultCallback(){
        //This fires from javascript
    }

    public void YourMethod(){
        JSExample(DefaultCallback);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Let&#39;s break this down:&lt;br&gt;
We declare our Javascript function called &amp;quot;JSExample&amp;quot;  as taking an &amp;quot;Action&amp;quot; reference. This is our function pointer that will get passed to Javascript.&lt;/p&gt;
&lt;p&gt;We then declare a &lt;strong&gt;static&lt;/strong&gt; function and mark it with &lt;code&gt;[MonoPInvokeCallback(typeof(Action))]&lt;/code&gt; which as you can probably guess, will tell the compiler to generate a function pointer that matches type &amp;quot;Action&amp;quot;.  &lt;em&gt;(Why do we use a static callback function? We&#39;ll get to that later.)&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Lastly, we can then call the Javascript function and pass in our static callback.&lt;/p&gt;
&lt;h2 id=&quot;on-the-javascript-side&quot;&gt;On the Javascript side &lt;a class=&quot;direct-link&quot; href=&quot;#on-the-javascript-side&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;This is where things start to get tricky. Fortunately, it&#39;s a lot of boilerplate code.&lt;/p&gt;
&lt;p&gt;First off, to call a C# function from a Javascript function you want to use:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Runtime.dynCall(signature,functionPtr,arguments);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;signature&lt;/strong&gt;: (string) return type followed by each argument type.&lt;/p&gt;
&lt;p&gt;v - void&lt;br&gt;
i - int&lt;br&gt;
f - float&lt;br&gt;
d - double&lt;/p&gt;
&lt;p&gt;example:&lt;br&gt;
&lt;em&gt;public static void SomeCallback(int id, string data)&lt;/em&gt;&lt;br&gt;
has the signature string:&lt;br&gt;
&lt;em&gt;&amp;quot;vii&amp;quot;&lt;/em&gt;&lt;br&gt;
(Why do string parameters use int? We&#39;ll get to that...)&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;functionPtr&lt;/strong&gt;: the C# function we want to call&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;arguments&lt;/strong&gt;: (array) the parameters to pass to the C# function&lt;/p&gt;
&lt;p&gt;In practice, it looks like this:&lt;br&gt;
(example.jslib)&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mergeInto(LibraryManager.library, {
    JSExample: function(functionPtr){
        Runtime.dynCall(&amp;quot;v&amp;quot;,functionPtr,[]);
    }
});
&lt;/code&gt;&lt;/pre&gt;
&lt;blockquote&gt;
&lt;p&gt;Sanity Check:  Your Javascript function name must match what you called your static extern function in C#, in this case &amp;quot;JSExample&amp;quot;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Seems simple so far?&lt;/p&gt;
&lt;h1 id=&quot;strings-and-things&quot;&gt;Strings and things &lt;a class=&quot;direct-link&quot; href=&quot;#strings-and-things&quot;&gt;#&lt;/a&gt;&lt;/h1&gt;
&lt;p&gt;So what if we want to pass some strings back and forth? For example, we want to use the &lt;a href=&quot;https://www.w3schools.com/jsref/met_win_prompt.asp&quot;&gt;Javascript &amp;quot;prompt()&amp;quot; command&lt;/a&gt; to get some text input from the user.  (Fun fact:  due to iOS security restrictions, this is currently the only way to get text input from iPads in Unity WebGL.)&lt;/p&gt;
&lt;p&gt;Prompt() takes a string as the message text, and optionally a second string as the default input text, it then returns the user&#39;s input (or null if they click cancel).&lt;/p&gt;
&lt;p&gt;Pretty simple in C#&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[DllImport(&amp;quot;__Internal&amp;quot;)]
private static extern string PromptText(string message, string text);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;And in JS...&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;PromptText: function(titlePtr,textPtr){
        var title=Pointer_stringify(titlePtr);
        var text = Pointer_stringify(textPtr);
        var val=prompt(title,text);
        var buffer=0;
        if(val){
            var size=lengthBytesUTF8(val)+1;
            buffer=_malloc(size);
            stringToUTF8(val,buffer,size);
        }
        return buffer;
    }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Yikes, that&#39;s a lot of code. Let&#39;s dive in!&lt;/p&gt;
&lt;p&gt;You can only pass primitive data types back and forth between C# and JS, and strings are not a primitive. Instead, the string is written to memory, and a pointer to that section of memory is passed to Javascript.  So we call &amp;quot;Pointer_stringify&amp;quot;  to fetch the string.&lt;/p&gt;
&lt;p&gt;When trying to pass the string from Javascript to C#, we do the same thing. We don&#39;t pass the string itself, but instead we copy the string to memory and then pass a pointer to that string back to C#.   &amp;quot;_malloc&amp;quot;  reserves a chunk of memory (aka &amp;quot;buffer&amp;quot;)  for us to copy our string into. We always use length+1 when reserving memory, as the last byte of a string is always 0x00 to signify the end of the data. &amp;quot;stringToUTF8&amp;quot;  does the actually copying for us.&lt;/p&gt;
&lt;p&gt;Keep in mind, that &amp;quot;prompt()&amp;quot; can return null. We handle this by checking &amp;quot;if(val)&amp;quot;  before copying the string. If they did click cancel, we just return 0, which C# will auto marshal as a null string.&lt;/p&gt;
&lt;h2 id=&quot;scope-and-closures&quot;&gt;Scope and Closures &lt;a class=&quot;direct-link&quot; href=&quot;#scope-and-closures&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;A pointer to a string passed in as a parameter will get included as the local scope of a closure.  However, the string this pointer refers to may not!  You should marshal any data you need before creating a closure.&lt;/p&gt;
&lt;h2 id=&quot;what-about-other-objects%3F&quot;&gt;What about other objects? &lt;a class=&quot;direct-link&quot; href=&quot;#what-about-other-objects%3F&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;While it is possible, it is a lot of extra work. In C# you have to use a &amp;quot;struct&amp;quot; with Explicit layout instead of a &amp;quot;class.&amp;quot;   In Javascript, you&#39;ll have to manually write data to the buffer to ensure it matches the C# struct &lt;em&gt;exactly&lt;/em&gt;   as it would be laid out in memory.  Keep in mind, that javascript data types don&#39;t always match up to their C# counterparts.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;OR&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;You could just use &lt;code&gt;JSON.stringify()&lt;/code&gt; to easily convert your object to a string and then pass it across just like we did in the &amp;quot;prompt()&amp;quot; example above. Nice and easy.&lt;/p&gt;
&lt;h1 id=&quot;using-non-static-callbacks&quot;&gt;Using non-static callbacks &lt;a class=&quot;direct-link&quot; href=&quot;#using-non-static-callbacks&quot;&gt;#&lt;/a&gt;&lt;/h1&gt;
&lt;p&gt;So remember earlier when we passed a static C# callback to Javascript?  That&#39;s a bit inconvenient. What if we just used a non-static callback?&lt;br&gt;
You&#39;ll get the follow error in your Javscript console:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;NotSupportedException: IL2CPP does not support marshaling delegates that point to instance methods to native code.
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;So you must use static delegates.  However, we know how to pass data back and forth, and now you can get around this limitation by building your own lookup table&lt;/p&gt;
&lt;p&gt;blah blah blah example code&lt;/p&gt;
</content>
	</entry>
</feed>
